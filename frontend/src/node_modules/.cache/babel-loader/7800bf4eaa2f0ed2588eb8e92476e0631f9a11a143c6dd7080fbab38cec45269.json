{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport { useEffect, useReducer, useRef } from 'react';\nfunction useFetch(url, options) {\n  const cache = useRef({});\n  const cancelRequest = useRef(false);\n  const initialState = {\n    error: undefined,\n    data: undefined\n  };\n  const fetchReducer = (state, action) => {\n    switch (action.type) {\n      case 'loading':\n        return Object.assign({}, initialState);\n      case 'fetched':\n        return Object.assign(Object.assign({}, initialState), {\n          data: action.payload\n        });\n      case 'error':\n        return Object.assign(Object.assign({}, initialState), {\n          error: action.payload\n        });\n      default:\n        return state;\n    }\n  };\n  const [state, dispatch] = useReducer(fetchReducer, initialState);\n  useEffect(() => {\n    if (!url) return;\n    cancelRequest.current = false;\n    const fetchData = () => __awaiter(this, void 0, void 0, function* () {\n      dispatch({\n        type: 'loading'\n      });\n      if (cache.current[url]) {\n        dispatch({\n          type: 'fetched',\n          payload: cache.current[url]\n        });\n        return;\n      }\n      try {\n        const response = yield fetch(url, options);\n        if (!response.ok) {\n          throw new Error(response.statusText);\n        }\n        const data = yield response.json();\n        cache.current[url] = data;\n        if (cancelRequest.current) return;\n        dispatch({\n          type: 'fetched',\n          payload: data\n        });\n      } catch (error) {\n        if (cancelRequest.current) return;\n        dispatch({\n          type: 'error',\n          payload: error\n        });\n      }\n    });\n    void fetchData();\n    return () => {\n      cancelRequest.current = true;\n    };\n  }, [url]);\n  return state;\n}\nexport default useFetch;","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","useEffect","useReducer","useRef","useFetch","url","options","cache","cancelRequest","initialState","error","undefined","data","fetchReducer","state","action","type","Object","assign","payload","dispatch","current","fetchData","response","fetch","ok","Error","statusText","json"],"sources":["/Users/jason/bizchina/node_modules/usehooks-ts/dist/esm/useFetch/useFetch.js"],"sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { useEffect, useReducer, useRef } from 'react';\nfunction useFetch(url, options) {\n    const cache = useRef({});\n    const cancelRequest = useRef(false);\n    const initialState = {\n        error: undefined,\n        data: undefined,\n    };\n    const fetchReducer = (state, action) => {\n        switch (action.type) {\n            case 'loading':\n                return Object.assign({}, initialState);\n            case 'fetched':\n                return Object.assign(Object.assign({}, initialState), { data: action.payload });\n            case 'error':\n                return Object.assign(Object.assign({}, initialState), { error: action.payload });\n            default:\n                return state;\n        }\n    };\n    const [state, dispatch] = useReducer(fetchReducer, initialState);\n    useEffect(() => {\n        if (!url)\n            return;\n        cancelRequest.current = false;\n        const fetchData = () => __awaiter(this, void 0, void 0, function* () {\n            dispatch({ type: 'loading' });\n            if (cache.current[url]) {\n                dispatch({ type: 'fetched', payload: cache.current[url] });\n                return;\n            }\n            try {\n                const response = yield fetch(url, options);\n                if (!response.ok) {\n                    throw new Error(response.statusText);\n                }\n                const data = (yield response.json());\n                cache.current[url] = data;\n                if (cancelRequest.current)\n                    return;\n                dispatch({ type: 'fetched', payload: data });\n            }\n            catch (error) {\n                if (cancelRequest.current)\n                    return;\n                dispatch({ type: 'error', payload: error });\n            }\n        });\n        void fetchData();\n        return () => {\n            cancelRequest.current = true;\n        };\n    }, [url]);\n    return state;\n}\nexport default useFetch;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}